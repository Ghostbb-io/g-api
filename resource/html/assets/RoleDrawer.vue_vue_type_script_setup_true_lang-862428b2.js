var N=Object.defineProperty;var y=Object.getOwnPropertySymbols;var C=Object.prototype.hasOwnProperty,F=Object.prototype.propertyIsEnumerable;var S=(e,a,t)=>a in e?N(e,a,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[a]=t,_=(e,a)=>{for(var t in a||(a={}))C.call(a,t)&&S(e,t,a[t]);if(y)for(var t of y(a))F.call(a,t)&&S(e,t,a[t]);return e};var b=(e,a,t)=>new Promise((u,i)=>{var m=l=>{try{p(t.next(l))}catch(c){i(c)}},d=l=>{try{p(t.throw(l))}catch(c){i(c)}},p=l=>l.done?u(l.value):Promise.resolve(l.value).then(m,d);p((t=t.apply(e,a)).next())});import{B as A}from"./BasicForm-33def721.js";import"./componentMap-c5f962c4.js";import{u as U}from"./useForm-61e3194d.js";import"./RadioButtonGroup-81fea792.js";import{s as T,a as V,e as M}from"./role-45b3624a.js";import{b as G}from"./index.js";import{m as L,d as q,f as g,u as o,c as $,_ as v,a9 as w,aa as k,l as O,ac as D,ad as W}from"./vue-5c68ae35.js";import{ak as j}from"./antd-12f11a56.js";import{a as z,B as E}from"./index-ae722a40.js";import{_ as I}from"./index-daeb014c.js";import{g as H}from"./menu-f81aa51d.js";import{b as J}from"./api-29ef4ec9.js";const K=e=>e==="api",Q=e=>e==="menu",me=[{title:"角色名稱",dataIndex:"roleName",width:200},{title:"角色",dataIndex:"role",width:180},{title:"狀態",dataIndex:"status",width:120,customRender:({record:e})=>(Reflect.has(e,"pendingStatus")||(e.pendingStatus=!1),L(j,{checked:e.status===!0,checkedChildren:"啟用",unCheckedChildren:"停用",loading:e.pendingStatus,onChange(a){e.pendingStatus=!0;const{createMessage:t}=G();T(e.role,a).then(()=>{e.status=a,t.success("已成功修改角色狀態")}).catch(()=>{t.error("修改角色狀態失敗")}).finally(()=>{e.pendingStatus=!1})}}))},{title:"創建時間",dataIndex:"createdAt",width:180},{title:"備註",dataIndex:"remark"}],de=[{field:"roleName",label:"角色名稱",component:"Input",colProps:{span:8}},{field:"status",label:"狀態",component:"Select",componentProps:{options:[{label:"啟用",value:!0},{label:"停用",value:!1}]},colProps:{span:8}}],X=[{field:"roleName",label:"角色名稱",required:!0,component:"Input"},{field:"role",label:"角色值",required:!0,component:"Input",componentProps:{disabled:!1}},{field:"status",label:"狀態",component:"RadioButtonGroup",defaultValue:!0,componentProps:{options:[{label:"啟用",value:!0},{label:"停用",value:!1}]}},{label:"備註",field:"remark",component:"InputTextArea"},{field:"type",label:"",component:"RadioButtonGroup",defaultValue:"menu",componentProps:{options:[{label:"目錄分配",value:"menu"},{label:"api分配",value:"api"}]}},{label:"",field:"menu",slot:"menu",component:"Input",ifShow:({values:e})=>Q(e.type)},{label:"",field:"api",slot:"api",component:"Input",ifShow:({values:e})=>K(e.type)}],fe=q({__name:"RoleDrawer",emits:["success","register"],setup(e,{emit:a}){const t=g(!0),u=g([]),i=g([]),[m,{resetFields:d,setFieldsValue:p,validate:l,updateSchema:c}]=U({labelWidth:90,baseColProps:{span:24},schemas:X,showActionButtonGroup:!1}),[R,{setDrawerProps:f,closeDrawer:P}]=z(s=>b(this,null,function*(){d(),f({confirmLoading:!1}),t.value=!!(s!=null&&s.isUpdate),o(u).length===0&&(u.value=yield H()),o(i).length===0&&(i.value=yield J()),o(t)&&p(_({},s.record)),c({field:"role",componentProps:{disabled:o(t)}})})),x=$(()=>o(t)?"編輯角色":"新增角色");function B(){return b(this,null,function*(){try{const s=yield l();f({confirmLoading:!0}),o(t)?yield M(s.role,s):yield V(s),P(),a("success")}finally{f({confirmLoading:!1})}})}return(s,Y)=>(v(),w(o(E),W(s.$attrs,{onRegister:o(R),showFooter:"",title:x.value,width:"500px",onOk:B}),{default:k(()=>[O(o(A),{onRegister:o(m)},{menu:k(({model:n,field:r})=>[n[r]!==""?(v(),w(o(I),{key:0,value:n[r],"onUpdate:value":h=>n[r]=h,treeData:u.value,fieldNames:{title:"title",key:"key"},blockNode:!0,title:"目錄分配",checkable:"",toolbar:""},null,8,["value","onUpdate:value","treeData"])):D("",!0)]),api:k(({model:n,field:r})=>[n[r]!==""?(v(),w(o(I),{key:0,value:n[r],"onUpdate:value":h=>n[r]=h,treeData:i.value,fieldNames:{title:"title",key:"key"},blockNode:!0,title:"Api分配",checkable:"",toolbar:""},null,8,["value","onUpdate:value","treeData"])):D("",!0)]),_:1},8,["onRegister"])]),_:1},16,["onRegister","title"]))}});export{fe as _,me as c,de as s};
