var I=(k,m,i)=>new Promise((l,f)=>{var t=n=>{try{u(i.next(n))}catch(c){f(c)}},w=n=>{try{u(i.throw(n))}catch(c){f(c)}},u=n=>n.done?l(n.value):Promise.resolve(n.value).then(t,w);u((i=i.apply(k,m)).next())});import{d as M,f as _,r as N,c as P,u as e,_ as U,$ as A,n as L,z as $,l as s,aa as o,E as p,a1 as y,al as K,F as O}from"./vue-5c68ae35.js";import{u as V,a as G,b as q,L as x,_ as W}from"./LoginFormTitle.vue_vue_type_script_setup_true_lang-ea17ed79.js";import{f as j,l as H,k as J,b as Q}from"./index.js";import{$ as h,w as z,a0 as X,B as S,O as Y,R as Z}from"./antd-12f11a56.js";const ne=M({__name:"LoginForm",setup(k){const m=Y,i=Z,l=h.Item,f=z.Password,{t}=J(),{notification:w,createErrorModal:u}=Q(),{prefixCls:n}=j("login"),c=H(),{setLoginState:R,getLoginState:B}=V(),{getFormRules:D}=G(),b=_(),v=_(!1),C=_(!1),d=N({account:"",password:""}),{validForm:T}=q(b),E=P(()=>e(B)===x.LOGIN);function F(){return I(this,null,function*(){const g=yield T();if(g)try{v.value=!0;const a=yield c.login({password:g.password,username:g.account,mode:"none"});a&&w.success({message:t("sys.login.loginSuccessTitle"),description:`${t("sys.login.loginSuccessDesc")}: ${a.realName}`,duration:3})}catch(a){u({title:t("sys.api.errorTip"),content:a.message||t("sys.api.networkExceptionMsg"),getContainer:()=>document.body.querySelector(`.${n}`)||document.body})}finally{v.value=!1}})}return(g,a)=>(U(),A(O,null,[L(s(W,{class:"enter-x"},null,512),[[$,E.value]]),L(s(e(h),{class:"p-4 enter-x",model:d,rules:e(D),ref_key:"formRef",ref:b,onKeypress:K(F,["enter"])},{default:o(()=>[s(e(l),{name:"account",class:"enter-x"},{default:o(()=>[s(e(z),{size:"large",value:d.account,"onUpdate:value":a[0]||(a[0]=r=>d.account=r),placeholder:e(t)("sys.login.userName"),class:"fix-auto-fill"},null,8,["value","placeholder"])]),_:1}),s(e(l),{name:"password",class:"enter-x"},{default:o(()=>[s(e(f),{size:"large",visibilityToggle:"",value:d.password,"onUpdate:value":a[1]||(a[1]=r=>d.password=r),placeholder:e(t)("sys.login.password")},null,8,["value","placeholder"])]),_:1}),s(e(i),{class:"enter-x"},{default:o(()=>[s(e(m),{span:12},{default:o(()=>[s(e(l),null,{default:o(()=>[s(e(X),{checked:C.value,"onUpdate:checked":a[2]||(a[2]=r=>C.value=r),size:"small"},{default:o(()=>[p(y(e(t)("sys.login.rememberMe")),1)]),_:1},8,["checked"])]),_:1})]),_:1}),s(e(m),{span:12},{default:o(()=>[s(e(l),{style:{"text-align":"right"}},{default:o(()=>[s(e(S),{type:"link",size:"small",onClick:a[3]||(a[3]=r=>e(R)(e(x).RESET_PASSWORD))},{default:o(()=>[p(y(e(t)("sys.login.forgetPassword")),1)]),_:1})]),_:1})]),_:1})]),_:1}),s(e(l),{class:"enter-x"},{default:o(()=>[s(e(S),{type:"primary",size:"large",block:"",onClick:F,loading:v.value},{default:o(()=>[p(y(e(t)("sys.login.loginButton")),1)]),_:1},8,["loading"]),s(e(S),{size:"large",class:"mt-4 enter-x",block:"",onClick:a[4]||(a[4]=r=>e(R)(e(x).REGISTER))},{default:o(()=>[p(y(e(t)("sys.login.registerButton")),1)]),_:1})]),_:1})]),_:1},8,["model","rules","onKeypress"]),[[$,E.value]])],64))}});export{ne as _};
